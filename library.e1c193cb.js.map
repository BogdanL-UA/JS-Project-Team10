{"mappings":"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","sources":["src/index-library.js","src/js/library/render-library.js","src/js/library/library-buttons-functions.js","src/js/library/clear-container.js","src/js/library/get-from-local-storage.js","src/js/library/on-library-load.js"],"sourcesContent":["import './js/open-movie-modal';\nimport './js/pagination';\nimport './js/authorisation';\nimport './js/library/on-library-load';\nimport './js/team-modal';\nimport './js/dark-theme';\nimport topUp from './js/top';\n\n// topUp();\n","import { FilmsApiService } from '../api-service';\nimport { refs } from '../refs';\nimport openMovieModal from '../open-movie-modal';\nimport closeMovieModalWindow from '../close-modal-window';\nimport Pagination from 'tui-pagination';\n\nconst generateGenresString = genres => {\n  if (genres.length <= 2) {\n    return genres.map(genre => genre.name).join(', ');\n  } else if (genres.length === 0) {\n    return 'no genres';\n  } else if (genres.length > 2) {\n    return (\n      genres\n        .map(genre => genre.name)\n        .slice(0, 2)\n        .join(', ') + ', Other'\n    );\n  }\n};\n\nconst createLibraryMovieItem = ({\n  id,\n  poster_path,\n  title,\n  genres,\n  release_date,\n  vote_average,\n}) => {\n  document.addEventListener('click', openMovieModal);\n  refs.closeModalIcon.addEventListener('click', closeMovieModalWindow);\n  const genresList = generateGenresString(genres);\n  return `\n    <li class=\"library__item\" data-id=\"${id}\">\n            <div class=\"library__poster\">\n                <img src=\"https://image.tmdb.org/t/p/w500${poster_path}\" alt=\"${title}\" class=\"library__image\" loading=\"lazy\" data-target=\"card\"/>\n            </div>\n            <div class=\"library__meta\">\n                <p class=\"library__title\" data-target=\"card\">${title}</p>\n                <p class=\"library__info\" data-target=\"card\">\n                    <span class=\"library__genre\">${genresList}</span> |\n                    <span class=\"library__year\">${release_date.slice(\n                      0,\n                      4\n                    )}</span>\n                    <span class=\"library__rate\">${String(vote_average).slice(\n                      0,\n                      3\n                    )}</span></p>\n            </div>\n        </li>\n    `;\n};\n\nconst filmsApiService = new FilmsApiService();\n\nfunction renderLibrary(movies) {\n  for (let i = 0; i < movies.length; i += 1)\n    filmsApiService.getFilmsById(movies[i]).then(response => {\n      refs.library.insertAdjacentHTML(\n        'beforeend',\n        createLibraryMovieItem(response)\n      );\n      paginationOnLibrary();\n    });\n}\n\nasync function paginationOnLibrary() {\n  const options = {\n    totalItems: filmsApiService.totalPages,\n    itemsPerPage: 3,\n    visiblePages: 5,\n    centerAlign: true,\n    firstItemClassName: 'tui-first-child',\n    lastItemClassName: 'tui-last-child',\n  };\n\n  const pagination = new Pagination(refs.pagination, options);\n  // pagination.reset();\n  await pagination.on('beforeMove', function (eventData) {\n    refs.library.innerHTML = '';\n  });\n  \n  await pagination.on('afterMove', function (eventData) {\n    filmsApiService.page = eventData.page;\n    filmsApiService.getFilmsById().then(films => {\n      filmsApiService.page = 1;\n      refs.library.innerHTML = createLibraryMovieItem(films.results);\n    });\n  });\n}\nexport { renderLibrary, paginationOnLibrary };\n","import { refs } from '../refs';\n\nconst activateWatchedBtn = () => {\n  refs.headerWatchedBtn.classList.add('library-header__btn--active');\n};\nconst activateQueueBtn = () => {\n  refs.headerQueueBtn.classList.add('library-header__btn--active');\n};\n\nconst deactivateWatchedBtn = () => {\n  refs.headerWatchedBtn.classList.remove('library-header__btn--active');\n};\n\nconst deactivateQueueBtn = () => {\n  refs.headerQueueBtn.classList.remove('library-header__btn--active');\n};\n\nexport { activateWatchedBtn, activateQueueBtn, deactivateWatchedBtn, deactivateQueueBtn };","import { refs } from '../refs';\n\nconst clearLibraryContainer = () => {\n  refs.library.innerHTML = '';\n};\n\nexport { clearLibraryContainer };\n","const getFromLocalStorage = key =>\n    JSON.parse(localStorage.getItem(`${key}Movies`));\n\nconst checkWatched = () => {\n    let watchedMovies = null;\n    try {\n        watchedMovies = getFromLocalStorage('watched');\n    } catch {\n        return;\n    }\n    return watchedMovies;\n}\n\nconst checkQueue = () => {\n    let queueMovies = null;\n    try {\n        queueMovies = getFromLocalStorage('queue');\n    } catch {\n        return;\n    }\n    return queueMovies;\n}\n  \nexport { checkWatched, checkQueue };","import { renderLibrary } from './render-library';\nimport { refs } from '../refs';\nimport {\n  activateWatchedBtn,\n  activateQueueBtn,\n  deactivateWatchedBtn,\n  deactivateQueueBtn,\n} from './library-buttons-functions';\nimport { clearLibraryContainer } from './clear-container';\nimport { checkWatched, checkQueue } from './get-from-local-storage';\n\nconst IMG_EMPTY_LIB =\n  '<image class=\"message__image\" src=\"https://thumbs.gfycat.com/AccurateUnfinishedBergerpicard-size_restricted.gif\"/>';\n\nlet watchedMovies = checkWatched() || [];\nlet queueMovies = checkQueue() || [];\n\n//перевірка local storage при завантаженні сторінки\nif (\n  (watchedMovies == null || watchedMovies.length === 0) &&\n  (queueMovies == null || queueMovies.length === 0)\n) {\n  //в localstorage нічого немає\n  refs.message.innerHTML = `<p class=\"message__text\">Your library is empty</p>${IMG_EMPTY_LIB}`;\n  refs.library.innerHTML = '';\n  refs.pagination.style.display = 'none';\n} else if (watchedMovies.length > 0) {\n  //в localstorage є переглянуті фільми (пріоритет)\n  activateWatchedBtn();\n  renderLibrary(watchedMovies);\n} else if (queueMovies.length > 0) {\n  //в localstorage є фільми в черзі\n  activateQueueBtn();\n  renderLibrary(queueMovies);\n}\n\n// колбеки\nconst onWatchedClick = event => {\n  deactivateQueueBtn();\n  activateWatchedBtn();\n  clearLibraryContainer();\n\n  // watchedMovies = getFromLocalStorage('watched');\n  watchedMovies = checkWatched();\n\n  if (watchedMovies == null || watchedMovies.length === 0) {\n    refs.message.innerHTML = `<p class=\"message__text\">Your list of watched films is empty</p>${IMG_EMPTY_LIB}`;\n    refs.library.innerHTML = '';\n    refs.pagination.style.display = 'none';\n  } else if (watchedMovies.length > 0) {\n    refs.message.innerHTML = '';\n    refs.pagination.style.display = 'flex';\n    renderLibrary(watchedMovies);\n  }\n};\n\nconst onQueueClick = event => {\n  activateQueueBtn();\n  deactivateWatchedBtn();\n  clearLibraryContainer();\n\n  // queueMovies = getFromLocalStorage('queue');\n  queueMovies = checkQueue();\n\n  if (queueMovies == null || queueMovies.length === 0) {\n    refs.message.innerHTML = `<p class=\"message__text\">Your queue is empty</p>${IMG_EMPTY_LIB}`;\n    refs.library.innerHTML = '';\n    refs.pagination.style.display = 'none';\n  } else if (queueMovies.length > 0) {\n    refs.message.innerHTML = '';\n    refs.pagination.style.display = 'flex';\n    renderLibrary(queueMovies);\n  }\n};\n\n// додаємо прослуховувачі подій на кнопки\nrefs.headerWatchedBtn.addEventListener('click', onWatchedClick);\nrefs.headerQueueBtn.addEventListener('click', onQueueClick);\n"],"names":["parcelRequire","$bpxeT","$b64488090ba80634$var$createLibraryMovieItem","param","id","poster_path","title","genres","release_date","vote_average","document","addEventListener","$8Tess","default","$4Nugj","refs","closeModalIcon","$1rHv3","genresList","length","map","genre","name","join","slice","$b64488090ba80634$var$generateGenresString","concat","String","$b64488090ba80634$var$filmsApiService","$1h2Gi","FilmsApiService","$b64488090ba80634$export$e7d1a4959038c5e5","movies","i","getFilmsById","then","response","library","insertAdjacentHTML","$b64488090ba80634$export$ddce8262da9035e5","$b64488090ba80634$var$_paginationOnLibrary","apply","this","arguments","$parcel$interopDefault","$2TvXO","mark","_callee","options","pagination","totalItems","totalPages","itemsPerPage","visiblePages","centerAlign","firstItemClassName","lastItemClassName","$1VFfL","on","eventData","innerHTML","page","films","results","$c7ba97f1b2bbd87b$export$cfde98e34fee1ead","headerWatchedBtn","classList","add","$c7ba97f1b2bbd87b$export$af8f632b06b38e33","headerQueueBtn","$63e1fe9c236b69b6$export$c7bf46721d78d01d","$1fa55a62841381e9$var$getFromLocalStorage","key","JSON","parse","localStorage","getItem","$1fa55a62841381e9$export$46ab00eaf26a0263","watchedMovies","e","$1fa55a62841381e9$export$91a863d22e939729","queueMovies","$86a9f5b8278c0293$var$IMG_EMPTY_LIB","$86a9f5b8278c0293$var$watchedMovies","$86a9f5b8278c0293$var$queueMovies","message","style","display","event","remove"],"version":3,"file":"library.e1c193cb.js.map"}